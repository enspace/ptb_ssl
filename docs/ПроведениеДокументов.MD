# Проведение документов

Набор методов для типового формирования проведения документов. Функционал учитывает рекомендации 1С по реализации контроля остатков следующим образом:

>Общая методика контроля остатков при проведении документа заключается в следующем: сначала, не глядя ни на что, нужно записать движения документа, а затем, когда движения уже записаны, прочитать из базы данных остатки.
>Если появились отрицательные остатки, значит, такой документ проводить нельзя. Нужно сообщить пользователю, каких материалов не хватает, и отменить проведение документа.
>Если же отрицательных остатков не появилось, тогда можно смело проводить документ.

---

[Быстрый старт. Проведение и контроль остатков][0]

---

## Описание

Укрупненно проведение документа происходит в два этапа, первый этап – подготовка и запись данных, второй этап – контроль отрицательных остатков.

Для формирования движений документа необходимо внести изменения модуль объекта и модуль менеджера документа:

- Документ (объект метаданных)
  - Проведение - Разрешить
  - Удаление движений - Не удалять автоматически
  - Запись движений при проведении - Записывать выбранные
- Модуль объекта ([bsl][1.1], [описание][1.2])
  - [ПередЗаписью][1.3]
  - [ОбработкаПроведения][1.4]
  - [ОбработкаУдаленияПроведения][1.5]
- Модуль менеджера ([bsl][2.1], [описание][2.2])
  - [ПодготовитьПараметрыПроведения][2.3]
  - [ВыполнитьДополнительныеПроверки][2.4]
  - [СформироватьДвиженияПоРегистрам][2.5]
  - [СформироватьСписокРегистровДляКонтроля][2.6] - используется для контроля остатков
  - [СообщитьКонтрольРезультатовПроведения][2.7] - используется для контроля остатков

Для контроля отрицательных остатков необходимо внести изменения в модуль набора записей каждого регистра, для которого выполняется контроль:

- Модуль набора записей регистра ([bsl][3.1], [описание][3.2])
  - [ВыполнитьКонтрольРезультатовПроведения][3.3]
  - [ПередЗаписью][3.4]
  - [ПриЗаписи][3.5]

[0]: ПроведениеДокументов/БыстрыйСтарт.MD

[1.1]: ПроведениеДокументов/Документ.МодульОбъекта.bsl
[1.2]: ПроведениеДокументов/Документ.МодульОбъекта.MD
[1.3]: ПроведениеДокументов/Документ.МодульОбъекта.MD#передзаписью
[1.4]: ПроведениеДокументов/Документ.МодульОбъекта.MD#обработкапроведения
[1.5]: ПроведениеДокументов/Документ.МодульОбъекта.MD#обработкаудаленияпроведения

[2.1]: ПроведениеДокументов/Документ.МодульМенеджера.bsl
[2.2]: ПроведениеДокументов/Документ.МодульМенеджера.MD
[2.3]: ПроведениеДокументов/Документ.МодульМенеджера.MD#ПодготовитьПараметрыПроведения
[2.4]: ПроведениеДокументов/Документ.МодульМенеджера.MD#ВыполнитьДополнительныеПроверки
[2.5]: ПроведениеДокументов/Документ.МодульМенеджера.MD#СформироватьДвиженияПоРегистрам
[2.6]: ПроведениеДокументов/Документ.МодульМенеджера.MD#СформироватьСписокРегистровДляКонтроля
[2.7]: ПроведениеДокументов/Документ.МодульМенеджера.MD#СообщитьКонтрольРезультатовПроведения

[3.1]: ПроведениеДокументов/Регистр.МодульНабораЗаписей.bsl
[3.2]: ПроведениеДокументов/Регистр.МодульНабораЗаписей.MD
[3.3]: ПроведениеДокументов/Регистр.МодульНабораЗаписей.MD#выполнитьконтрольрезультатовпроведения
[3.4]: ПроведениеДокументов/Регистр.МодульНабораЗаписей.MD#передзаписью
[3.5]: ПроведениеДокументов/Регистр.МодульНабораЗаписей.MD#призаписи